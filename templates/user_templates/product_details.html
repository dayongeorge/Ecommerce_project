{% extends 'user_templates/base.html' %}
{% load static %}
{% block content %}


<style>
  #content-wrapper{
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
}

.column{
    width: 100%%;
    padding: 10px;

}

#featured{
    max-width: 500px;
    max-height: 600px;

    cursor: pointer;
    

}

.thumbnail{
    object-fit: cover;
    max-width: 180px;
    max-height: 100px;
    cursor: pointer;
    opacity: 0.5;
    margin: 5px;
 

}

.thumbnail:hover{
    opacity:1;
}

.active{
    opacity: 1;
}

#slide-wrapper{
    margin-top: 30px;
    max-width: 500px;
    display: flex;
    min-height: 100px;
    align-items: center;
    margin-left: auto;
    margin-right: auto;
    justify-content: space-around;
   
}

#slider{
    width: 440px;
    display: flex;
    flex-wrap: nowrap;
    overflow-x: auto;
    border: solid 1px #e8e8e8;
    box-shadow: 0px 1px 5px rgba(0,0,0,0.1);

}

#slider::-webkit-scrollbar {
        width: 8px;

}

#slider::-webkit-scrollbar-track {
    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);

}
 
#slider::-webkit-scrollbar-thumb {
  background-color: #dede2e;
  outline: 1px solid slategrey;
   border-radius: 100px;

}

#slider::-webkit-scrollbar-thumb:hover{
    background-color: #18b5ce;
}

.arrow{
    width: 30px;
    height: 30px;
    cursor: pointer;
    transition: .3s;
    
}

.arrow:hover{
    opacity: .5;
    width: 35px;
    height: 35px;
}

#img-container{
    z-index: 1;
    max-width: 600px;
    position: relative;
    display:flex;
    justify-content: center;
    align-items: center;
    border: solid 1px #e8e8e8;
    box-shadow: 0px 1px 5px rgba(0,0,0,0.1);
}

#lens{
    z-index: 2;
    position: absolute;

    height: 400px;
    width: 400px;
    border:2px solid black;
    background-repeat: no-repeat;
    cursor: none;

}
.review-section{
    color: #fff;
    text-transform: uppercase;
    height: 100px;
    
    max-width: 250px;
    width: 100%;
    background-color: #a8a4a0;
    font-size: 24px;
    font-family: 'Josefin Sans';
    padding: 35px 10px;
}
  
   {% comment %} <div class="col-lg-6" style="margin-left: -80px;">
                <div class="product_img_slide owl-carousel">
                    
                    <div class="single_product_img" style="width:500px; height=400px";>
                       
                        <img src="{{single_product.product_image.url}}" alt="{{data.name}}" class="img-fluid ">
        
                    </div>
                </div>
                <div id="slide-wrapper" >
                  <img id="slideLeft" style="margin-right: 10px;" class="arrow" src="{% static 'arrow-images/arrow-left.png' %}">
            
                  <div id="slider">
                              <img class="thumbnail active" src="{{product.product_image.url}}">
                              {% for image in images %}
                    <img class="thumbnail"  src="{{image.image.url}}">
                              {% endfor %}
                    
                    
              
                  </div>
            
                  <img id="slideRight" style="margin-left: 10px;" class="arrow" src="{% static 'arrow-images/arrow-right.png' %}">
                </div>
                </div> {% endcomment %}



</style>

    <main>
        <!--================Single Product Area =================-->
        <div class="container" style="margin-top:-140px;">
        <div class="product_image_area">
            
            <div class="row">
              <div class="col-lg-6 column">
                  <div id="img-container">
                    <div style="border:none; display:block; position: absolute; z-index:3;" id="lens"></div>
                    <img id="featured" src="{{single_product.product_image.url}}">
                  </div>
                  <div id="slide-wrapper" >
                    <img id="slideLeft" style="margin-right: 10px;" class="arrow" src="{% static 'arrow-images/arrow-left.png' %}">
              
                    <div id="slider">
                                <img class="thumbnail active" src="{{product.product_image.url}}">
                                {% for image in images %}
                      <img class="thumbnail"  src="{{image.image.url}}">
                                {% endfor %}
                     </div>
              
                    <img id="slideRight" style="margin-left: 10px;" class="arrow" src="{% static 'arrow-images/arrow-right.png' %}">
                  </div>
              </div>
           
                
                <div class="col-lg-6" >
                
                    <p>{{single_product.brand}}</p>
                   <h4 class="mt-3">{{single_product.name}}</h4>
                   <h6 class="mt-3">product review</h6>
                   <h5 class="mt-3"> <span style="color:grey;"><s> MRP ₹{{single_product.original_price}} </s></span>  OFFER PRICE  <span style="font-weight:bold;">${{single_product.offer_price}} </span></h5>
                   <h6 class="mt-2"><span style="color:grey;">(Inclusive of all taxes)</span></h6>
                   <h6 class="mt-3">Maritime from Titan - Sea Green Chronograph Watch with Lateen sail inspired indices</h6>
                    {% comment %} <div class="card_area">
                        <div class="product_count_area">
                            <p>Net Qty</p>
                            <div class="product_count d-inline-block">
                                <span class="product_count_item inumber-decrement"> <i class="ti-minus"></i></span>
                                <input class="product_count_item input-number" type="text" value="1" min="1" max="10">
                                <span class="product_count_item number-increment"> <i class="ti-plus"></i></span>
                            </div>
                            <p>$5</p>
                        </div>
                        <p>Colors available:</p> {% endcomment %}

                     <div class="row pt-5">
                        {% if single_product.quantity <= 0 %}
                          <h5 class="text-danger">Out of Stock</h5>
                            {% else %}
                                {% if in_cart %}
                                    <div class="add_to_cart ml-5 pt-5">
                                        <a  class="added-to-cart-btn" style="color: white;">Added to Cart <i class="fa fa-check"></i></a>
                                    </div>
                                    <div class="add_to_cart ml-5  pt-5">
                                        <a href="{% url 'cart' %}" class="view-cart-btn">View Cart <i class="fas fa-eye"></i></a>
                                   </div>

                                {% else %}
                                <div class="add_to_cart ml-5">
                                    <a  href="{% url 'add_cart' single_product.id %}" class="add-to-cart-btn">ADD TO CART</a>

                                </div>
                                <div class="add_to_cart ml-2">
                                    <a href="" class="buy-now-btn">BUY NOW</a>

                                </div>
                                {% endif %}
                        {% endif %}
                    </div>
             
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!--================End Single Product Area =================-->
        <!-- subscribe part here -->
        {% comment %} <section class="subscribe_part section_padding">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="subscribe_part_content">
                            <h2>Get promotions & updates!</h2>
                            <p>Seamlessly empower fully researched growth strategies and interoperable internal or “organic” sources credibly innovate granular internal .</p>
                            <div class="subscribe_form">
                                <input type="email" placeholder="Enter your mail">
                                <a href="#" class="btn_1">Subscribe</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section> {% endcomment %}
        <!-- subscribe part end -->
    </main>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    {% comment %} <script>
        $(document).ready(function() {
            $('.add-to-cart-btn').click(function(event) {
              event.preventDefault();
              var url = $(this).attr('href');
          
              $.ajax({
                url: url,
                type: 'GET',
                dataType: 'json',
                success: function(response) {
                  if (response.success) {
                    alert('Product added to cart successfully!');
                  } else {
                    alert('Error: ' + response.message);
                  }
                },
                error: function(xhr, ajaxOptions, thrownError) {
                  alert('Error: ' + xhr.status + ' ' + thrownError);
                }
              });
            });
          });
          
          
          
    </script> {% endcomment %}

    <script>
        $(document).ready(function() {
          $('.add-to-cart-btn').click(function(event) {
            event.preventDefault();
            var url = $(this).attr('href');
      
            $.ajax({
              url: url,
              type: 'GET',
              dataType: 'json',
              success: function(response) {
                if (response.success) {
                  // Show success message
                  alert('Product added to cart successfully!');
                  $('.add-to-cart-btn').text('Added to Cart');
                  $('.add-to-cart-btn').addClass('added-to-cart-btn');
                  $('.add-to-cart-btn').removeClass('add-to-cart-btn');
                  $('.buy-now-btn').text('View Cart');
                  $('.buy-now-btn').addClass('view-cart-btn');
                  $('.buy-now-btn').removeClass('buy-now-btn');
                } else {
                  // Show error message
                  alert('Error: ' + response.message);
                }
              },
              error: function(xhr, ajaxOptions, thrownError) {
                alert('Error: ' + xhr.status + ' ' + thrownError);
              }
            });
          });
        });
      </script>


{% comment %} ################image zoom and thumbnails {% endcomment %}


      <script type="text/javascript" >
        let thumbnails = document.getElementsByClassName('thumbnail')
      
      let activeImages = document.getElementsByClassName('active')
      
      for (var i=0; i < thumbnails.length; i++){
      
      thumbnails[i].addEventListener('click', function(){
      console.log(activeImages)
      
      if (activeImages.length > 0){
      activeImages[0].classList.remove('active')
      }
      
      
      this.classList.add('active')
      document.getElementById('featured').src = this.src
      })
      }
      
      
      let buttonRight = document.getElementById('slideRight');
      let buttonLeft = document.getElementById('slideLeft');
      
      buttonLeft.addEventListener('click', function(){
      document.getElementById('slider').scrollLeft -= 180
      })
      
      buttonRight.addEventListener('click', function(){
      document.getElementById('slider').scrollLeft += 180
      })
      </script>
      <script type="text/javascript"  >
      
        window.addEventListener("load", function() {
          // Get the div element
          let lens = document.getElementById('lens')
          lens.style.display = "none"
          
          // Remove the div element from the DOM
         
        });
      
        document.getElementById('img-container').addEventListener('mouseover', function(){
            imageZoom('featured')
            
        })
        document.getElementById('img-container').addEventListener('mouseout', function(){
          let lens = document.getElementById('lens')
          lens.style.display = "none"
            
        })
        
        function imageZoom(imgID){
            let img = document.getElementById(imgID)
            let lens = document.getElementById('lens')
            lens.style.display = "block"
            lens.style.backgroundImage = `url( ${img.src} )`
        
            let ratio = 5
        
            lens.style.backgroundSize = (img.width * ratio) + 'px ' + (img.height * ratio) + 'px';
        
            img.addEventListener("mousemove", moveLens)
            lens.addEventListener("mousemove", moveLens)
            img.addEventListener("touchmove", moveLens)
        
            function moveLens(){
                /*
                Function sets sets position of lens over image and background image of lens
                1 - Get cursor position
                2 - Set top and left position using cursor position - lens width & height / 2
                3 - Set lens top/left positions based on cursor results
                4 - Set lens background position & invert
                5 - Set lens bounds
            
                */
        
                //1
                let pos = getCursor()
                //console.log('pos:', pos)
        
                //2
                let positionLeft =  pos.x - (lens.offsetWidth / 2)
                let positionTop = pos.y - (lens.offsetHeight / 2)
        
                //5
                if(positionLeft < 0 ){
                    positionLeft = 0
                }
        
                if(positionTop < 0 ){
                    positionTop = 0
                }
        
                if(positionLeft > img.width - lens.offsetWidth /3 ){
                    positionLeft = img.width - lens.offsetWidth /3
                }
        
                if(positionTop > img.height - lens.offsetHeight /3 ){
                    positionTop = img.height - lens.offsetHeight /3
                }
        
        
                //3
                lens.style.left = 500 + positionLeft + 'px';
                lens.style.top = positionTop + 'px';
        
                //4
                lens.style.backgroundPosition = "-" + (pos.x * ratio) + 'px -' +  (pos.y * ratio) + 'px'
            }
        
            function getCursor(){
                /* Function gets position of mouse in dom and bounds
                 of image to know where mouse is over image when moved
                
                1 - set "e" to window events
                2 - Get bounds of image
                3 - set x to position of mouse on image using pageX/pageY - bounds.left/bounds.top
                4- Return x and y coordinates for mouse position on image
                
                 */
        
                let e = window.event
                let bounds = img.getBoundingClientRect()
        
                //console.log('e:', e)
                //console.log('bounds:', bounds)
                let x = e.pageX - bounds.left
                let y = e.pageY - bounds.top
                x = x - window.pageXOffset;
                y = y - window.pageYOffset;
                
                return {'x':x, 'y':y}
            }
        
        }
        
        imageZoom('featured')
      </script>
      
  
    {% endblock  %}